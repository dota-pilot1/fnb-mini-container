================================================================
실무 백엔드(Spring Boot + MyBatis) 이해를 위한 핵심 30가지
================================================================

================================================================
기본 구조 (1~5)
================================================================

1. @Transactional 동작 원리
----------------------------------------------------------------
  - Spring은 @Transactional을 프록시 객체로 감싸서 처리
  - 같은 클래스 내에서 자기 메서드를 호출하면 프록시를 거치지 않음
    → 트랜잭션이 적용 안 됨 (Self-Invocation 문제)
  - 해결책: Self-Proxy 패턴 (자기 자신을 @Autowired로 주입)
  - 현업 코드에서 직접 등장한 패턴 (CrdtCardAck)

  핵심 질문:
    "왜 같은 클래스 안에서 호출하면 @Transactional이 안 먹히나?"


2. MyBatis 동작 방식
----------------------------------------------------------------
  - Mapper 인터페이스 → XML(SQL) → DB 순으로 실행
  - SqlSession이 DB 연결을 담당
  - #{} : PreparedStatement (SQL 인젝션 방지, 값 바인딩)
  - ${} : 문자열 직접 치환 (테이블명, 컬럼명 동적 처리 시 사용, 위험)
  - resultMap : DB 컬럼명과 Java 필드명 매핑 (snake_case → camelCase)
  - map-underscore-to-camel-case: true 설정으로 자동 변환 가능

  핵심 질문:
    "#{} 와 ${} 의 차이와 각각 언제 쓰는가?"


3. Spring Bean 생명주기 + DI
----------------------------------------------------------------
  - @Component, @Service, @Repository, @Controller
    → 전부 Bean 등록이지만 계층별 의미 구분
  - 생성자 주입 (권장): 불변성 보장, 테스트 용이
  - 필드 주입 (@Autowired): 간편하지만 테스트 어려움
  - @RequiredArgsConstructor (Lombok): final 필드 생성자 자동 생성

  핵심 질문:
    "왜 생성자 주입을 권장하는가?"


4. Spring MVC 요청 흐름
----------------------------------------------------------------
  요청 → DispatcherServlet → HandlerMapping → Controller
       → Service → Mapper → DB
       → 응답 역순

  - @RequestBody  : JSON → Java 객체 (역직렬화)
  - @ResponseBody : Java 객체 → JSON (직렬화)
  - @RestController = @Controller + @ResponseBody
  - DTO로 요청/응답 데이터 분리 (Entity 직접 노출 금지)

  핵심 질문:
    "DispatcherServlet이 하는 역할은?"


5. Spring Security + JWT
----------------------------------------------------------------
  - 필터 체인 구조: 요청이 Controller 도달 전에 Security 필터 통과
  - JWT 흐름:
      로그인 → 토큰 발급 → 요청마다 헤더에 토큰 첨부
      → JwtFilter에서 토큰 검증 → SecurityContext에 인증 정보 세팅
  - 권한 처리: @PreAuthorize, SecurityContext의 Authentication 객체

  핵심 질문:
    "JWT 토큰 검증은 어느 시점에, 어디서 이루어지는가?"

================================================================
